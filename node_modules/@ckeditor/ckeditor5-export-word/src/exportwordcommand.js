/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x10a0bf}from'ckeditor5/src/core.js';import{getStyles as _0x35c42a,getConverterOptions as _0x459903,getConverterOptionsV2 as _0x53a85d}from'./utils.js';export default class e extends _0x10a0bf{constructor(_0x132008){super(_0x132008),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x42a1b0={}){const _0x20b9b4=this['editor'],t=_0x20b9b4['t'],_0x492cfd=0x2===(_0x42a1b0['version']||0x1),_0x3009ee=_0x42a1b0['converterUrl']||(_0x492cfd?'https://docx-converter.cke-cs.com/v2/convert/html-docx':'https://docx-converter.cke-cs.com/v1/convert'),_0x27f8f0=_0x42a1b0['converterOptions']||{},_0x34d9a4=_0x20b9b4['plugins']['get']('ExportWord'),_0x194005=_0x42a1b0['token']||_0x34d9a4['_token'],_0x1feaee=!0x1!==_0x27f8f0['auto_pagination'],_0x32951d=_0x42a1b0['dataCallback']||(_0x5227fb=>_0x5227fb['data']['get']({'pagination':_0x1feaee}));return this['isBusy']=!0x0,this['refresh'](),_0x35c42a(_0x42a1b0['stylesheets']||['EDITOR_STYLES'])['then'](async _0x3d413f=>{_0x20b9b4['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20started'));const _0x5d8c92=await _0x32951d(_0x20b9b4),_0x288e57={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x20b9b4['locale']['contentLanguageDirection']+'\x22>'+_0x5d8c92+'</div>','css':_0x3d413f,[_0x492cfd?'config':'options']:{..._0x27f8f0,..._0x492cfd?_0x53a85d(_0x20b9b4):_0x459903(_0x20b9b4)}},_0x5e9e67={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x194005?{'Authorization':_0x194005['value']}:null},'body':JSON['stringify'](_0x288e57)};return window['fetch'](_0x3009ee,_0x5e9e67)['then'](_0xccfe7b=>{if(0xc8!==_0xccfe7b['status'])throw _0xccfe7b;return _0xccfe7b['blob']();})['then'](_0x1e933b=>{_0x20b9b4['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20successful'));const _0x4d59a4='function'==typeof _0x42a1b0['fileName']?_0x42a1b0['fileName']():_0x42a1b0['fileName'];this['_downloadFile'](_0x1e933b,_0x4d59a4||'document.docx');});})['catch'](_0x34af6f=>{const _0x4c5fc9=_0x20b9b4['plugins']['get']('Notification');throw _0x20b9b4['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20failed'),{'politeness':'assertive'}),_0x4c5fc9['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x34af6f;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0xaa5f6e,_0x1fc5a3){const _0x634cd4=document['createElement']('a');_0x634cd4['href']=window['URL']['createObjectURL'](_0xaa5f6e),_0x634cd4['download']=_0x1fc5a3,_0x634cd4['click'](),_0x634cd4['remove']();}}