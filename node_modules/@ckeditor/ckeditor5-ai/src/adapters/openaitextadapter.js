/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x16317f=_0x45f8;function _0x56f6(){const _0x1082c7=['system','_readStaticResponse','Instruction:\x0a','message','stream','pluginName','sendRequest','_isBufferIncomplete','1897505wUopcI','_requestParameters','AI_ERROR_CONTEXT_LENGTH','Your\x20task\x20is\x20to\x20generate\x20HTML\x20content\x20accordingly\x20to\x20the\x20given\x20instruction.\x20Never\x20include\x20<img>\x20tag\x20in\x20your\x20response\x20even\x20if\x20asked\x20for.\x20Your\x20answer\x20must\x20be\x20a\x20well-structured\x20and\x20properly\x20formatted\x20HTML\x20code.\x20Answer\x20only\x20with\x20the\x20generated\x20HTML\x20content.\x20Do\x20not\x20add\x20any\x20additional\x20remarks\x20or\x20notes.\x20Do\x20not\x20act\x20like\x20a\x20chatbot\x20or\x20a\x20real\x20person.','AI_ERROR_MODERATION','locale','151854YZtOIU','ai.openAI.apiUrl','264rWSoip','Your\x20task\x20is\x20to\x20execute\x20the\x20instruction\x20using\x20the\x20provided\x20HTML\x20content.\x20Follow\x20the\x20instruction\x20closely.\x20Your\x20answer\x20must\x20be\x20a\x20properly\x20formatted\x20HTML\x20code.\x20Do\x20not\x20add\x20any\x20additional\x20remarks\x20or\x20notes.\x20Do\x20not\x20act\x20like\x20a\x20chatbot\x20or\x20a\x20real\x20person.','choices','context_length_exceeded','data:\x20','parse','define','decode','_readStreamableResponse','content','prepareMessages','join','_requestHeaders','ai.openAI.requestParameters','_prepareRequestParameters','text','_cleanUpData','map','getReader','_apiUrl','10282206lSIiih','10tNmQwV','ai.openAI.requestHeaders','317072uMqrwW','195410eakmmp','read','config','editor','body','abortController','[DONE]','gpt-3.5-turbo','91rhYcdH','get','https://api.openai.com/v1/chat/completions','filter','includes','delta','OpenAITextAdapter','POST','split','\x0aYou\x20must\x20keep\x20the\x20text\x20formatting.\x0a\x0aContent:\x0a','_prepareRequestHeaders','resolve','signal','Moderation','replace','json','user','length','reject','stringify','2253339NQeAVE','51174mSlTsg','4ouMlmT'];_0x56f6=function(){return _0x1082c7;};return _0x56f6();}(function(_0x231143,_0x551e96){const _0x195db2=_0x45f8,_0x3eed13=_0x231143();while(!![]){try{const _0x175e67=-parseInt(_0x195db2(0x1b5))/0x1+parseInt(_0x195db2(0x1b4))/0x2+-parseInt(_0x195db2(0x18a))/0x3+parseInt(_0x195db2(0x18c))/0x4*(parseInt(_0x195db2(0x195))/0x5)+-parseInt(_0x195db2(0x19b))/0x6*(-parseInt(_0x195db2(0x1bd))/0x7)+-parseInt(_0x195db2(0x19d))/0x8*(parseInt(_0x195db2(0x18b))/0x9)+-parseInt(_0x195db2(0x1b2))/0xa*(-parseInt(_0x195db2(0x1b1))/0xb);if(_0x175e67===_0x551e96)break;else _0x3eed13['push'](_0x3eed13['shift']());}catch(_0x391a4f){_0x3eed13['push'](_0x3eed13['shift']());}}}(_0x56f6,0xa2ff7));function _0x45f8(_0x55d9ea,_0x1d5de8){const _0x56f635=_0x56f6();return _0x45f8=function(_0x45f8e9,_0x365689){_0x45f8e9=_0x45f8e9-0x17e;let _0x2bb5fc=_0x56f635[_0x45f8e9];return _0x2bb5fc;},_0x45f8(_0x55d9ea,_0x1d5de8);}import{default as _0x1bc189}from'./aitextadapter.js';import{AIRequestError as _0x1a8e38}from'./aiadapter.js';import{getTranslation as _0x2febe4}from'../utils/common-translations.js';export default class F extends _0x1bc189{static get[_0x16317f(0x192)](){const _0xd1230a=_0x16317f;return _0xd1230a(0x1c3);}constructor(_0x318a54){const _0x44d845=_0x16317f;super(_0x318a54),_0x318a54[_0x44d845(0x1b7)][_0x44d845(0x1a3)](_0x44d845(0x19c),_0x44d845(0x1bf)),_0x318a54[_0x44d845(0x1b7)][_0x44d845(0x1be)](_0x44d845(0x1aa))||_0x318a54[_0x44d845(0x1b7)][_0x44d845(0x1a3)](_0x44d845(0x1aa),{'model':_0x44d845(0x1bc),'max_tokens':0x7d0,'temperature':0x1,'top_p':0x1,'stream':!0x0}),this[_0x44d845(0x1b0)]=_0x318a54[_0x44d845(0x1b7)][_0x44d845(0x1be)](_0x44d845(0x19c)),this[_0x44d845(0x1a9)]=_0x318a54[_0x44d845(0x1b7)][_0x44d845(0x1be)](_0x44d845(0x1b3))||{},this[_0x44d845(0x196)]=_0x318a54[_0x44d845(0x1b7)][_0x44d845(0x1be)](_0x44d845(0x1aa));}async[_0x16317f(0x193)]({query:_0x2d3ca4,context:_0x104a32,onData:_0x5881fb,actionId:_0x2d736a}){const _0x5506b0=_0x16317f,_0x11ea1a=this[_0x5506b0(0x1b8)][_0x5506b0(0x19a)],_0x1362bc=await this[_0x5506b0(0x1a7)](_0x2d3ca4,_0x104a32,_0x2d736a),_0x1c75eb=await this[_0x5506b0(0x180)](this[_0x5506b0(0x1a9)],_0x2d736a),_0x10e707=await this[_0x5506b0(0x1ab)](this[_0x5506b0(0x196)],_0x2d736a),_0x272599={'messages':_0x1362bc,..._0x10e707},_0x45e0b3={'method':_0x5506b0(0x1c4),'headers':_0x1c75eb,'body':JSON[_0x5506b0(0x189)](_0x272599),'signal':this[_0x5506b0(0x1ba)][_0x5506b0(0x182)]},_0x208e2c=await fetch(this[_0x5506b0(0x1b0)],_0x45e0b3);if(_0x208e2c['ok'])return _0x10e707[_0x5506b0(0x191)]?await this[_0x5506b0(0x1a5)](_0x208e2c,_0x5881fb):await this[_0x5506b0(0x18e)](_0x208e2c,_0x5881fb),Promise[_0x5506b0(0x181)]();{const _0x49eca3=await _0x208e2c[_0x5506b0(0x1ac)]();return _0x49eca3[_0x5506b0(0x1c1)](_0x5506b0(0x1a0))?Promise[_0x5506b0(0x188)](new _0x1a8e38(_0x2febe4(_0x11ea1a,_0x5506b0(0x197)))):_0x49eca3[_0x5506b0(0x1c1)](_0x5506b0(0x183))?Promise[_0x5506b0(0x188)](new _0x1a8e38(_0x2febe4(_0x11ea1a,_0x5506b0(0x199)))):Promise[_0x5506b0(0x188)](new Error(_0x49eca3));}}async[_0x16317f(0x1a7)](_0x5b1429,_0x5a19cb,_0x59ced2){const _0x545f78=_0x16317f;let _0x580554,_0x93482c;return _0x5a19cb?(_0x580554=_0x545f78(0x19e),_0x93482c=_0x545f78(0x18f)+_0x5b1429+_0x545f78(0x17f)+_0x5a19cb):(_0x580554=_0x545f78(0x198),_0x93482c=_0x5b1429),[{'role':_0x545f78(0x18d),'content':_0x580554},{'role':_0x545f78(0x186),'content':_0x93482c}];}async[_0x16317f(0x1a5)](_0x3076ba,_0x5d28a2){const _0x3517d3=_0x16317f,_0x37a26c=_0x3076ba[_0x3517d3(0x1b9)][_0x3517d3(0x1af)](),_0x2f0687=new TextDecoder();let _0x219933='',_0x14bb54='',_0x13b8c3='',_0x29937c=!0x1;for(;!_0x29937c;){const {done:_0x287fcc,value:_0x3eea8d}=await _0x37a26c[_0x3517d3(0x1b6)](),_0xe9bb83=_0x219933+_0x2f0687[_0x3517d3(0x1a4)](_0x3eea8d);let _0x5bcf83='';_0x29937c=_0x287fcc;try{_0x5bcf83=this[_0x3517d3(0x1ad)](_0xe9bb83),_0x219933='';}catch(_0x15beac){_0x219933=_0xe9bb83;continue;}_0x14bb54+=_0x5bcf83,!_0x29937c&&this[_0x3517d3(0x194)](_0x14bb54)||_0x14bb54&&(_0x13b8c3+=_0x14bb54,_0x14bb54='',_0x5d28a2(_0x13b8c3));}return Promise[_0x3517d3(0x181)]();}async[_0x16317f(0x18e)](_0x4e408c,_0x240d35){const _0x3a6af8=_0x16317f;return _0x240d35((await _0x4e408c[_0x3a6af8(0x185)]())[_0x3a6af8(0x19f)][0x0][_0x3a6af8(0x190)][_0x3a6af8(0x1a6)]),Promise[_0x3a6af8(0x181)]();}[_0x16317f(0x194)](_0x2291df){const _0x44c70e=_0x16317f,_0x2ba665=_0x2291df[_0x44c70e(0x17e)]('<')[_0x44c70e(0x187)]!==_0x2291df[_0x44c70e(0x17e)]('>')[_0x44c70e(0x187)],_0x303f8f=_0x2291df[_0x44c70e(0x187)]<0x1e;return _0x2ba665&&_0x303f8f;}[_0x16317f(0x1ad)](_0x218df0){const _0x253681=_0x16317f;return _0x218df0[_0x253681(0x17e)](/\n(?![^{]*\})/g)[_0x253681(0x1ae)](_0x19ffa3=>_0x19ffa3[_0x253681(0x184)](_0x253681(0x1a1),''))[_0x253681(0x1c0)](_0x566cda=>_0x566cda&&_0x566cda[_0x253681(0x187)]>0x0&&_0x253681(0x1bb)!==_0x566cda)[_0x253681(0x1ae)](_0x5dff46=>{const _0x556a0b=_0x253681,{choices:_0xf371f7}=JSON[_0x556a0b(0x1a2)](_0x5dff46);if(_0xf371f7[0x0]&&_0xf371f7[0x0][_0x556a0b(0x1c2)]&&_0xf371f7[0x0][_0x556a0b(0x1c2)][_0x556a0b(0x1a6)])return _0xf371f7[0x0][_0x556a0b(0x1c2)][_0x556a0b(0x1a6)];})[_0x253681(0x1c0)](_0x18cb3f=>_0x18cb3f)[_0x253681(0x1a8)]('');}}