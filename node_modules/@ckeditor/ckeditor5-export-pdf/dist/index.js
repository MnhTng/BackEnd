/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0xd9c06c,Plugin as _0xa1cea0}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x4e909e,MenuBarMenuListItemButtonView as _0x5d2aa3,SpinnerView as _0x128435,Notification as _0x393347}from'@ckeditor/ckeditor5-ui/dist/index.js';function f(){const _0x393555=[],_0x203841=[];for(const _0x965b0 of Array['from'](document['styleSheets'])){if(_0x965b0['ownerNode']['hasAttribute']('data-cke')){for(const _0x159cf2 of Array['from'](_0x965b0['cssRules']))-0x1!==_0x159cf2['cssText']['indexOf']('.ck-content')?_0x393555['push'](_0x159cf2['cssText']):-0x1!==_0x159cf2['cssText']['indexOf'](':root')&&_0x203841['push'](_0x159cf2['cssText']);}}return _0x393555['length']||console['warn']('The\x20editor\x20stylesheet\x20could\x20not\x20be\x20found\x20in\x20the\x20document.\x20Check\x20your\x20webpack\x20config\x20â€“\x20style-loader\x20should\x20use\x20data-cke=true\x20attribute\x20for\x20the\x20editor\x20stylesheet.'),[..._0x203841,..._0x393555]['join']('\x20')['trim']();}class o extends _0xd9c06c{constructor(_0x42ba46){super(_0x42ba46),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x26b726={}){const _0x129074=this['editor'],t=_0x129074['t'],_0x12d389=_0x26b726['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0x347df8=_0x26b726['dataCallback']||(_0x18e1f7=>_0x18e1f7['data']['get']()),_0x305f70=_0x129074['plugins']['get']('ExportPdf'),_0x1d54fe=_0x26b726['token']||_0x305f70['_token'];return this['isBusy']=!0x0,this['refresh'](),function(_0x169d45){if(!_0x169d45)return new Promise(_0x9e44b6=>_0x9e44b6(''));const _0x5accc7=[];for(const _0x49b887 of _0x169d45)'EDITOR_STYLES'!==_0x49b887?_0x5accc7['push'](window['fetch'](_0x49b887)['then'](_0x181b92=>_0x181b92['text']())):_0x5accc7['push'](f());return Promise['all'](_0x5accc7)['then'](_0x583cf1=>_0x583cf1['join']('\x20')['trim']());}(_0x26b726['stylesheets']||['EDITOR_STYLES'])['then'](async _0x55e188=>{_0x129074['ui']['ariaLiveAnnouncer']['announce'](t('PDF\x20export\x20started'));const _0xb6ff90={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<title>CKEditor\x205\x20PDF\x20document</title>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x129074['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+await _0x347df8(_0x129074)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09</body>\x0a\x09\x09\x09\x09\x09</html>','css':_0x55e188,'options':_0x26b726['converterOptions']},_0x50f5c6={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x1d54fe?{'Authorization':_0x1d54fe['value']}:null,'x-cs-app-id':_0x26b726['appID']||'cke5'},'body':JSON['stringify'](_0xb6ff90)};return window['fetch'](_0x12d389,_0x50f5c6)['then'](_0x50c9e3=>{if(0xc8!==_0x50c9e3['status'])throw _0x50c9e3;return _0x50c9e3['blob']();})['then'](_0x24cd5=>{_0x129074['ui']['ariaLiveAnnouncer']['announce'](t('PDF\x20export\x20successful'));const _0x378d53='function'==typeof _0x26b726['fileName']?_0x26b726['fileName']():_0x26b726['fileName'];this['_downloadFile'](_0x24cd5,_0x378d53||'document.pdf');});})['catch'](_0x48ad52=>{const _0x5292fb=_0x129074['plugins']['get']('Notification');throw _0x129074['ui']['ariaLiveAnnouncer']['announce'](t('PDF\x20export\x20failed'),{'politeness':'assertive'}),_0x5292fb['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x48ad52;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x3d5e3c,_0x22b2ad){const _0x3fb910=document['createElement']('a');_0x3fb910['href']=window['URL']['createObjectURL'](_0x3d5e3c),_0x3fb910['download']=_0x22b2ad,_0x3fb910['click'](),_0x3fb910['remove']();}}class i extends _0xa1cea0{static get['pluginName'](){return'ExportPdfUI';}['init'](){const _0x47c11a=this['editor'];_0x47c11a['ui']['componentFactory']['add']('exportPdf',()=>{const _0xe026a=this['_createButton'](_0x4e909e),_0x5a7652=_0x47c11a['commands']['get']('exportPdf');return _0xe026a['set']({'tooltip':!0x0}),_0xe026a['bind']('isOn')['to'](_0x5a7652,'isBusy'),_0xe026a;}),_0x47c11a['ui']['componentFactory']['add']('menuBar:exportPdf',()=>this['_createButton'](_0x5d2aa3));}['_createButton'](_0x114957){const _0x43cc41=this['editor'],_0x2694a8=_0x43cc41['config']['get']('exportPdf')||{},t=_0x43cc41['locale']['t'],_0x122fbc=_0x43cc41['commands']['get']('exportPdf'),_0x46e960=new _0x114957(_0x43cc41['locale']),_0x35506c=new _0x128435();return _0x46e960['children']['add'](_0x35506c),_0x35506c['bind']('isVisible')['to'](_0x122fbc,'isBusy'),_0x46e960['iconView']['bind']('isVisible')['to'](_0x122fbc,'isBusy',_0x24ff66=>!_0x24ff66),_0x46e960['set']({'icon':'<svg\x20viewBox=\x220\x200\x2020\x2020\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M19\x204.5\x2014\x200H3v6.5h1.5v-5h8v5h5V11H19V4.5ZM14\x202l3.3\x203H14V2Z\x22/><path\x20d=\x22m12.452\x2018.5\x201.25\x201.5H3v-3h1.5v1.5h7.952Z\x22/><path\x20d=\x22M19.826\x2016.843a.75.75\x200\x201\x200-1.152-.96L17.5\x2017.29V13H16v4.29l-1.174-1.408a.75.75\x200\x201\x200-1.152.96l2.346\x202.816a.95.95\x200\x200\x200\x201.46\x200l2.346-2.815Z\x22/><path\x20d=\x22M1.63\x2014.24V12.3h.88c.66\x200\x201.14-.15\x201.46-.45.32-.3.48-.71.48-1.24\x200-.52-.15-.91-.44-1.2C3.7\x209.15\x203.28\x209\x202.69\x209H0v5.24h1.63Zm.4-3h-.4v-1.17h.46c.3\x200\x20.5.05.62.17.1.11.16.25.16.42\x200\x20.16-.06.3-.19.41-.13.11-.34.16-.66.16l.01.01Zm5.7\x203c.28\x200\x20.6-.05.96-.14.26-.07.5-.21.73-.42.22-.2.4-.47.53-.77.12-.31.19-.75.19-1.3\x200-.37-.04-.7-.13-1.02a2.3\x202.3\x200\x200\x200-.42-.84c-.19-.24-.43-.43-.72-.56C8.57\x209.06\x208.2\x209\x207.72\x209h-2.4v5.24H7.73Zm-.4-1.19h-.4v-2.86h.4c.43\x200\x20.73.1.91.3.18.2.27.59.27\x201.14\x200\x20.42-.04.73-.12.91a.76.76\x200\x200\x201-.34.4c-.14.07-.38.11-.72.11Zm5.3\x201.2V12.1h2.02v-1.06h-2.03v-.91H15V9h-4v5.24h1.62l.01.01Z\x22/></svg>\x0a'}),_0x46e960['bind']('isEnabled')['to'](_0x122fbc,'isEnabled'),_0x46e960['bind']('label')['to'](_0x122fbc,'isBusy',_0x181869=>t(_0x181869?'Exporting\x20PDF\x20document':'Export\x20to\x20PDF')),this['listenTo'](_0x46e960,'execute',()=>{_0x43cc41['execute']('exportPdf',_0x2694a8),_0x43cc41['editing']['view']['focus']();}),_0x46e960;}}class s extends _0xa1cea0{['_token'];static get['pluginName'](){return'ExportPdf';}static get['requires'](){return['CloudServices',_0x393347,i];}['init'](){const _0x3aa070=this['editor'],_0x1528e9=_0x3aa070['config']['get']('exportPdf')||{};_0x3aa070['commands']['add']('exportPdf',new o(_0x3aa070));const _0x1d28b7=_0x3aa070['plugins']['get']('CloudServices');!0x1===_0x1528e9['tokenUrl']?this['_token']=null:_0x1528e9['tokenUrl']?_0x1d28b7['registerTokenUrl'](_0x1528e9['tokenUrl'])['then'](_0x515885=>{this['_token']=_0x515885;}):this['_token']=_0x1d28b7['token'];}}export{s as ExportPdf};