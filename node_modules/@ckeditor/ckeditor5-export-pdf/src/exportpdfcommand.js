/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x47f7ce}from'ckeditor5/src/core.js';import{getStyles as _0x118099}from'./utils.js';export default class o extends _0x47f7ce{constructor(_0x48894f){super(_0x48894f),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x26c66b={}){const _0x3e82d2=this['editor'],t=_0x3e82d2['t'],_0x5837b9=_0x26c66b['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0x33812c=_0x26c66b['dataCallback']||(_0x2426ec=>_0x2426ec['data']['get']()),_0x36d4f2=_0x3e82d2['plugins']['get']('ExportPdf'),_0x5eb460=_0x26c66b['token']||_0x36d4f2['_token'];return this['isBusy']=!0x0,this['refresh'](),_0x118099(_0x26c66b['stylesheets']||['EDITOR_STYLES'])['then'](async _0x3b2882=>{_0x3e82d2['ui']['ariaLiveAnnouncer']['announce'](t('PDF\x20export\x20started'));const _0x4b53e9={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<title>CKEditor\x205\x20PDF\x20document</title>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x3e82d2['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+await _0x33812c(_0x3e82d2)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09</body>\x0a\x09\x09\x09\x09\x09</html>','css':_0x3b2882,'options':_0x26c66b['converterOptions']},_0x44ca7f={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x5eb460?{'Authorization':_0x5eb460['value']}:null,'x-cs-app-id':_0x26c66b['appID']||'cke5'},'body':JSON['stringify'](_0x4b53e9)};return window['fetch'](_0x5837b9,_0x44ca7f)['then'](_0x5e2b4d=>{if(0xc8!==_0x5e2b4d['status'])throw _0x5e2b4d;return _0x5e2b4d['blob']();})['then'](_0x254d30=>{_0x3e82d2['ui']['ariaLiveAnnouncer']['announce'](t('PDF\x20export\x20successful'));const _0xa2cb6b='function'==typeof _0x26c66b['fileName']?_0x26c66b['fileName']():_0x26c66b['fileName'];this['_downloadFile'](_0x254d30,_0xa2cb6b||'document.pdf');});})['catch'](_0x5d9bbd=>{const _0x5e75c3=_0x3e82d2['plugins']['get']('Notification');throw _0x3e82d2['ui']['ariaLiveAnnouncer']['announce'](t('PDF\x20export\x20failed'),{'politeness':'assertive'}),_0x5e75c3['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x5d9bbd;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x5ad80b,_0x59dd68){const _0x76056a=document['createElement']('a');_0x76056a['href']=window['URL']['createObjectURL'](_0x5ad80b),_0x76056a['download']=_0x59dd68,_0x76056a['click'](),_0x76056a['remove']();}}